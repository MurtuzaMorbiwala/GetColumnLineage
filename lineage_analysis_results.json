[
  {
    "model": "customers",
    "column": "CUSTOMER_ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): [\"stg_customers.CUSTOMER_ID\"]\nReasoning: The column \"CUSTOMER_ID\" in the \"customers\" model is of type NUMBER, which matches the data type of the \"CUSTOMER_ID\" column in the \"stg_customers\" upstream model. Additionally, the column name \"CUSTOMER_ID\" is consistent across both models, suggesting a direct lineage between the two."
  },
  {
    "model": "customers",
    "column": "FIRST_NAME",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): [stg_customers.FIRST_NAME]\nReasoning: The column name \"FIRST_NAME\" is identical in both the customers model and the stg_customers upstream model, indicating that the data in the FIRST_NAME column of the customers model was likely sourced from the FIRST_NAME column of the stg_customers model."
  },
  {
    "model": "customers",
    "column": "LAST_NAME",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): [stg_customers.LAST_NAME]\nReasoning: The column name and data type (TEXT) match the column in the upstream model stg_customers."
  },
  {
    "model": "customers",
    "column": "FIRST_ORDER_DATE",
    "column_type": "DATE",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "**Upstream Column(s):** ORDER_DATE\n**Reasoning:** The most likely upstream column is ORDER_DATE from the **stg_orders** model. The **stg_customers** model does not include a column named **FIRST_ORDER_DATE**, so it is unlikely that this column was derived directly from there. However, the **FIRST_ORDER_DATE** column in the **customers** model likely represents the first date on which a customer placed an order, which is likely to have been derived from the **ORDER_DATE** column in the **stg_orders** model."
  },
  {
    "model": "customers",
    "column": "MOST_RECENT_ORDER_DATE",
    "column_type": "DATE",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_orders.ORDER_DATE\nReasoning: The column name \"MOST_RECENT_ORDER_DATE\" suggests that it was derived from a table containing order information. The stg_orders table has a column named \"ORDER_DATE\", which is a likely candidate for the upstream column."
  },
  {
    "model": "customers",
    "column": "NUMBER_OF_ORDERS",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): \"CUSTOMER_ID\" from \"stg_customers\"\nReasoning: The \"NUMBER_OF_ORDERS\" column is likely a count of orders associated with each customer. The \"stg_orders\" table contains a \"CUSTOMER_ID\" column that references the \"CUSTOMER_ID\" column in the \"stg_customers\" table, indicating that the \"NUMBER_OF_ORDERS\" column was likely derived from the \"stg_orders\" table."
  },
  {
    "model": "stg_payments",
    "column": "ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stripe.payment.ID\nReasoning: The column ID is a common primary key column name. It is likely that the ID column in the stg_payments table was created using the ID column from the stripe.payment table. The fact that the column exists both upstream and downstream adds to the likelihood that they are the same column."
  },
  {
    "model": "stg_payments",
    "column": "ORDERID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): ID\nReasoning: The column ORDERID in the stg_payments model has the same name as the ID column in the stripe.payment upstream model. It is common practice to use the primary key of an upstream table as the foreign key in a downstream table to establish a relationship between the two tables. Therefore, it is likely that the ID column in the stripe.payment model was used to create the ORDERID column in the stg_payments model."
  },
  {
    "model": "stg_payments",
    "column": "PAYMENTMETHOD",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): PAYMENTMETHOD from stripe.payment\nReasoning: The column name PAYMENTMETHOD is identical in both the stg_payments model and the stripe.payment upstream model, indicating that the data in this column was likely inherited directly from the upstream column."
  },
  {
    "model": "stg_payments",
    "column": "STATUS",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): STATUS\nReasoning: The column name is identical to the column name in the upstream model, which suggests that the data was directly copied from the upstream source without any transformations."
  },
  {
    "model": "stg_payments",
    "column": "AMOUNT",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stripe.payment.AMOUNT\nReasoning: The stg_payments.AMOUNT column has the same name as the stripe.payment.AMOUNT column, which suggests that the latter was used directly to create the former. Additionally, the data type of the stg_payments.AMOUNT column is NUMBER, which is consistent with the data type of the stripe.payment.AMOUNT column."
  },
  {
    "model": "stg_payments",
    "column": "CREATED",
    "column_type": "DATE",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stripe.payment.CREATED\nReasoning: The column name in the stg_payments table is identical to the column name in the stripe.payment table, and both columns are of the same data type (DATE). This suggests that the data in the CREATED column in the stg_payments table was likely sourced from the CREATED column in the stripe.payment table."
  },
  {
    "model": "stg_payments",
    "column": "_BATCHED_AT",
    "column_type": "TIMESTAMP_NTZ",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.stripe.payment",
        "name": "stripe.payment",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): _BATCHED_AT\nReasoning: The column name \"_BATCHED_AT\" is present in both the source \"stripe.payment\" model and the target \"stg_payments\" model. This suggests that the \"_BATCHED_AT\" column in \"stg_payments\" was likely created using data from the \"_BATCHED_AT\" column in \"stripe.payment\"."
  },
  {
    "model": "cltv",
    "column": "CUSTOMER_ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_payments",
        "name": "stg_payments",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): CUSTOMER_ID\nReasoning: The column CUSTOMER_ID exists in the upstream models stg_customers and stg_orders. It is common to use customer ID as a primary key in a customer table and to reference it in related tables like orders. Therefore, it is likely that the CUSTOMER_ID column in the cltv model was inherited from either stg_customers or stg_orders."
  },
  {
    "model": "cltv",
    "column": "TOTAL_REVENUE",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_payments",
        "name": "stg_payments",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_payments.AMOUNT\nReasoning: The column \"TOTAL_REVENUE\" is likely derived from the \"AMOUNT\" column in the upstream table \"stg_payments\". This is because \"TOTAL_REVENUE\" is a numerical value and \"AMOUNT\" is the only numerical column in the upstream tables that could be used to calculate revenue."
  },
  {
    "model": "cltv",
    "column": "AVERAGE_ORDER_INTERVAL",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_payments",
        "name": "stg_payments",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_orders.ORDER_DATE\nReasoning: The AVERAGE_ORDER_INTERVAL column is likely derived from the ORDER_DATE column of the stg_orders table. This column contains the date of each order, which can be used to calculate the interval between orders."
  },
  {
    "model": "orderfrequency",
    "column": "CUSTOMER_ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_customers.CUSTOMER_ID\nReasoning: The column CUSTOMER_ID in the orderfrequency model is of type NUMBER, which is the same data type as the CUSTOMER_ID column in the stg_customers model. Additionally, the name of the column suggests that it is likely to be related to customer information. Since the stg_customers model contains customer-related data, it is likely that the CUSTOMER_ID column in the orderfrequency model was derived from the CUSTOMER_ID column in the stg_customers model."
  },
  {
    "model": "orderfrequency",
    "column": "NUMBER_OF_ORDERS",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_orders.CUSTOMER_ID\nReasoning: The name of the column in the downstream model, \"NUMBER_OF_ORDERS,\" suggests that it is a count of the number of orders placed by a customer. The upstream model \"stg_orders\" contains a column named \"CUSTOMER_ID\" which is a unique identifier for each customer. Therefore, it is likely that the column \"NUMBER_OF_ORDERS\" was created by counting the number of rows in the \"stg_orders\" table where the \"CUSTOMER_ID\" column matches the \"CUSTOMER_ID\" column in the \"stg_customers\" table."
  },
  {
    "model": "orderfrequency",
    "column": "AVERAGE_ORDER_INTERVAL",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_customers",
        "name": "stg_customers",
        "columns": [
          "CUSTOMER_ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      },
      {
        "id": "model.jaffle_shop.stg_orders",
        "name": "stg_orders",
        "columns": [
          "ORDER_ID",
          "CUSTOMER_ID",
          "ORDER_DATE",
          "STATUS"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_orders.ORDER_DATE\nReasoning: The column name \"AVERAGE_ORDER_INTERVAL\" suggests that it measures the average time between orders. This requires data about the dates of orders, which is likely stored in the \"ORDER_DATE\" column of the \"stg_orders\" table."
  },
  {
    "model": "payment_success_rate",
    "column": "SUCCESS_RATE",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "model.jaffle_shop.stg_payments",
        "name": "stg_payments",
        "columns": [
          "ID",
          "ORDERID",
          "PAYMENTMETHOD",
          "STATUS",
          "AMOUNT",
          "CREATED",
          "_BATCHED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): STATUS\nReasoning: The payment_success_rate model likely uses the STATUS column from the stg_payments upstream model to determine the success rate of payments. The STATUS column typically indicates whether a payment was successful or not, and this information is crucial for calculating the success rate."
  },
  {
    "model": "stg_orders",
    "column": "ORDER_ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.orders",
        "name": "jaffle_shop.orders",
        "columns": [
          "ID",
          "USER_ID",
          "ORDER_DATE",
          "STATUS",
          "_ETL_LOADED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): [jaffle_shop.orders.ID]\nReasoning: The stg_orders.ORDER_ID column is likely derived from the jaffle_shop.orders.ID column because they both represent a unique identifier for an order. This is a common naming convention for primary key columns in staging tables."
  },
  {
    "model": "stg_orders",
    "column": "CUSTOMER_ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.orders",
        "name": "jaffle_shop.orders",
        "columns": [
          "ID",
          "USER_ID",
          "ORDER_DATE",
          "STATUS",
          "_ETL_LOADED_AT"
        ]
      }
    ],
    "gemini_analysis": "**Upstream Column(s):** USER_ID\n\n**Reasoning:**\nThe column name \"CUSTOMER_ID\" suggests that it represents customer information. The \"jaffle_shop.orders\" table contains a column called \"USER_ID\", which could be the source of the customer's unique identifier in the \"stg_orders\" table."
  },
  {
    "model": "stg_orders",
    "column": "ORDER_DATE",
    "column_type": "DATE",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.orders",
        "name": "jaffle_shop.orders",
        "columns": [
          "ID",
          "USER_ID",
          "ORDER_DATE",
          "STATUS",
          "_ETL_LOADED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): jaffle_shop.orders.ORDER_DATE\nReasoning: The stg_orders.ORDER_DATE column has the same name as the jaffle_shop.orders.ORDER_DATE column, and both are of the same data type (DATE). This suggests that the stg_orders.ORDER_DATE column was likely created by copying data from the jaffle_shop.orders.ORDER_DATE column."
  },
  {
    "model": "stg_orders",
    "column": "STATUS",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.orders",
        "name": "jaffle_shop.orders",
        "columns": [
          "ID",
          "USER_ID",
          "ORDER_DATE",
          "STATUS",
          "_ETL_LOADED_AT"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): stg_orders.STATUS\nReasoning: The column name is identical to the upstream column, suggesting it was directly copied or renamed."
  },
  {
    "model": "stg_customers",
    "column": "CUSTOMER_ID",
    "column_type": "NUMBER",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.customers",
        "name": "jaffle_shop.customers",
        "columns": [
          "ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): jaffle_shop.customers.ID\nReasoning: The stg_customers table is a staging table for the customers table. The CUSTOMER_ID column in the stg_customers table likely corresponds to the ID column in the jaffle_shop.customers table. This is because the ID column is a common identifier for customers in many systems."
  },
  {
    "model": "stg_customers",
    "column": "FIRST_NAME",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.customers",
        "name": "jaffle_shop.customers",
        "columns": [
          "ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      }
    ],
    "gemini_analysis": "Upstream Column(s): [jaffle_shop.customers.FIRST_NAME]\nReasoning: The stg_customers.FIRST_NAME column has the same name and data type as the jaffle_shop.customers.FIRST_NAME column, which is a common indication of direct lineage. Additionally, the jaffle_shop.customers model is listed as a direct upstream model for stg_customers, further supporting this connection."
  },
  {
    "model": "stg_customers",
    "column": "LAST_NAME",
    "column_type": "TEXT",
    "upstream_models": [
      {
        "id": "source.jaffle_shop.jaffle_shop.customers",
        "name": "jaffle_shop.customers",
        "columns": [
          "ID",
          "FIRST_NAME",
          "LAST_NAME"
        ]
      }
    ],
    "gemini_analysis": "    Upstream Column(s): LAST_NAME\n    Reasoning: The column with the same name in the upstream model is likely to be the source of the column in the target model when no direct lineage information is available."
  }
]